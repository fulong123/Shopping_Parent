<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dream.shopping.addressserver.mapper.AddressMapper">

    <select id="selectAll" parameterType="com.dream.shopping.facade.vo.AddressVo" resultType="com.dream.shopping.facade.po.Address">
        select * from address
        <where>
            <include refid="selectAddress"/>
        </where>
    </select>
    <sql id="selectAddress">
        <if test="constomAddress != null">
            <if test="constomAddress.consigneeName!=null and constomAddress.consigneeName!=''">
                and consignee_name = "${constomAddress.consigneeName}"
            </if>
        </if>
    </sql>

    <select id="selectAddressById" parameterType="java.lang.Integer" resultType="com.dream.shopping.facade.po.Address">
        select * from address where addressId = #{value}
    </select>
    <insert id="insertAddress" parameterType="com.dream.shopping.facade.po.Address">
        <selectKey keyProperty="addressId" order="AFTER" resultType="java.lang.Integer">
            select last_insert_id()
        </selectKey>
        insert into address(consigneeName, deliveryTime, detailedAddress, distributionArea, email, isDefault, landmarkBuilding, phone, postalCode, telNum)
        values (#{consigneeName},#{deliveryTime},#{detailedAddress},#{distributionArea},#{email},#{isDefault},#{landmarkBuilding},#{phone},#{postalCode},#{telNum})
    </insert>

    <update id="updateAddress" parameterType="com.dream.shopping.facade.po.Address">
        update address set consigneeName=#{consigneeName},deliveryTime=#{deliveryTime},detailedAddress=#{detailedAddress},distributionArea=#{distributionArea},
                           email=#{email},isDefault=#{isDefault},landmarkBuilding=#{landmarkBuilding},phone=#{phone},postalCode=#{postalCode},telNum=#{telNum}
    </update>

    <delete id="deleteAddressById" parameterType="java.lang.Integer">
        delete from address where addressId=#{addressId}
    </delete>
</mapper>